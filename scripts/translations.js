// Translation file for portfolio content

/**
 * Calculates and formats experience duration between two dates with internationalization support
 * 
 * @param {string} startDate - The start date in ISO format (YYYY-MM-DD)
 * @param {string} [language='en'] - The language for formatting ('en' for English, 'pt' for Portuguese)
 * @param {string|null} [endDate=null] - The end date in ISO format. If null, uses current date
 * 
 * @returns {string} Formatted experience duration string
 * 
 * @example
 * // For ongoing experience (no end date)
 * calculateExperience('2021-01-01', 'en') // Returns "4 years+" (as of Aug 2025)
 * calculateExperience('2021-01-01', 'pt') // Returns "4 anos+" (as of Aug 2025)
 * 
 * // For completed experience (with end date)
 * calculateExperience('2018-01-01', 'en', '2023-01-01') // Returns "5 years"
 * calculateExperience('2018-01-01', 'pt', '2023-01-01') // Returns "5 anos"
 * 
 * // For short duration
 * calculateExperience('2024-01-01', 'en') // Returns "8 months" (as of Aug 2025)
 */
function calculateExperience(startDate, language = 'en', endDate = null) {
  // Parse dates
  const start = new Date(startDate);
  const end = endDate ? new Date(endDate) : new Date();
  
  // Calculate time difference
  const diffTime = Math.abs(end - start);
  const diffYears = diffTime / (1000 * 60 * 60 * 24 * 365.25);
  
  // Define language-specific text mappings
  const textMappings = {
    en: {
      month: { singular: 'month', plural: 'months' },
      year: { singular: 'year', plural: 'years' }
    },
    pt: {
      month: { singular: 'mês', plural: 'meses' },
      year: { singular: 'ano', plural: 'anos' }
    }
  };
  
  const texts = textMappings[language] || textMappings.en;
  
  // Handle duration less than 1 year
  if (diffYears < 1) {
    const months = Math.floor(diffYears * 12);
    const monthText = months === 1 ? texts.month.singular : texts.month.plural;
    return `${months} ${monthText}`;
  }
  
  // Handle duration of 1+ years
  const years = Math.floor(diffYears);
  const remainingMonths = Math.floor((diffYears - years) * 12);
  const yearText = years === 1 ? texts.year.singular : texts.year.plural;
  
  // Return with or without plus sign based on remaining months
  return remainingMonths === 0 ? `${years} ${yearText}` : `${years} ${yearText}+`;
}

// Start dates for different experiences
const EXPERIENCE_START_DATES = {
  testAutomation: '2021-01-01',
  nursing: {
    start: '2018-01-01',
    end: '2023-01-01'
  }
};

const translations = {
  en: {
    // Navigation
    nav: {
      about: "About",
      experience: "Experience",
      projects: "Projects",
      contact: "Contact"
    },
    
    // Profile Section
    profile: {
      greeting: "Hello, I'm",
      name: "Pedro Robalo",
      title: "Software Engineer",
      downloadCV: "Download CV",
      contactInfo: "Contact Info"
    },
    
    // About Section
    about: {
      sectionSubtitle: "Get To Know More",
      sectionTitle: "About Me",
      experienceTitle: "Experience",
      experienceText: `${calculateExperience(EXPERIENCE_START_DATES.testAutomation, 'en')} / ${calculateExperience(EXPERIENCE_START_DATES.nursing.start, 'en', EXPERIENCE_START_DATES.nursing.end)}<br/>Test Automation Engineer / Registered Nurse`,
      educationTitle: "Education",
      educationText: "Bachelor's Degree in Computer Science<br/>Bachelor's Degree in Nursing",
      description: `I am a passionate Software Engineer with a unique background spanning both healthcare and technology. With over ${calculateExperience(EXPERIENCE_START_DATES.testAutomation, 'en')} of experience as a Test Automation Engineer and a foundation in nursing, I bring a detail-oriented, problem-solving mindset to everything I do. My journey from healthcare to tech has taught me the importance of precision, user-centered thinking, and continuous learning. I specialize in test automation frameworks and quality assurance, while constantly expanding my skills in full-stack development. I thrive on building robust, scalable solutions and am always eager to tackle new challenges and explore emerging technologies.`
    },
    
    // Experience Section
    experience: {
      sectionSubtitle: "Explore My",
      sectionTitle: "Experience",
      frontend: {
        title: "Frontend Development",
        skills: {
          html: { name: "HTML", level: "Experienced" },
          css: { name: "CSS", level: "Basic" },
          tailwind: { name: "Tailwind", level: "Intermediate" },
          react: { name: "React", level: "Basic" },
          svelte: { name: "Svelte", level: "Basic" },
          nextjs: { name: "Next.js", level: "Basic" }
        }
      },
      backend: {
        title: "Backend Development",
        skills: {
          nodejs: { name: "Node.js", level: "Intermediate" },
          prisma: { name: "Prisma", level: "Basic" },
          django: { name: "Django", level: "Basic" },
          mongodb: { name: "MongoDB", level: "Basic" },
          mysql: { name: "MySQL", level: "Basic" },
          graphql: { name: "GraphQL", level: "Basic" }
        }
      },
      testAutomation: {
        title: "Test Automation",
        skills: {
          javascript: { name: "JavaScript", level: "Experienced" },
          typescript: { name: "TypeScript", level: "Experienced" },
          python: { name: "Python", level: "Experienced" },
          selenium: { name: "Selenium", level: "Intermediate" },
          appium: { name: "Appium", level: "Experienced" },
          cypress: { name: "Cypress", level: "Experienced" },
          detox: { name: "Detox", level: "Experienced" },
          playwright: { name: "Playwright", level: "Experienced" }
        }
      }
    },
    
    // Projects Section
    projects: {
      sectionSubtitle: "Browse My Recent",
      sectionTitle: "Projects",
      projectOne: {
        title: "Joke Teller",
        description: "This project is about a funny robot that tells jokes.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectTwo: {
        title: "Nike Store",
        description: "This project is an e-commerce platform for Nike products.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectThree: {
        title: "Music Player",
        description: "This project is a music player application built with vanilla JavaScript.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectFour: {
        title: "Animated Navigation",
        description: "This project showcases an animated navigation menu.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectFive: {
        title: "Animated Template",
        description: "This project is an animated template showcasing various animations and transitions.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectSix: {
        title: "Quote Generator",
        description: "This project is an inspirational quote generator that fetches random quotes from an API.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectSeven: {
        title: "Infinite Scroll",
        description: "This project demonstrates infinite scroll functionality with dynamic content loading.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectEight: {
        title: "Custom Countdown",
        description: "An interactive countdown timer application with customizable events and dates.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectNine: {
        title: "Book Keeper",
        description: "A bookmarking application for organizing and managing your favorite websites and resources.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectTen: {
        title: "Form Validator",
        description: "A client-side form validation application with real-time feedback and input sanitization.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectEleven: {
        title: "Spock Rock Game",
        description: "An enhanced Rock-Paper-Scissors game featuring Spock and Lizard with animated gameplay.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectTwelve: {
        title: "NASA APOD",
        description: "Explore NASA's Astronomy Picture of the Day with this interactive application featuring space imagery.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectThirteen: {
        title: "Math Sprint Game",
        description: "A fast-paced mathematical quiz game to test and improve your arithmetic skills under time pressure.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectFourteen: {
        title: "Drag and Drop",
        description: "An interactive drag-and-drop application demonstrating HTML5 drag events and dynamic UI interactions.",
        github: "GitHub",
        liveDemo: "Live Demo"
      },
      projectFifteen: {
        title: "Calculator",
        description: "A fully functional calculator application with simple mathematical operations.",
        github: "GitHub",
        liveDemo: "Live Demo"
      }
    },
    
    // Contact Section
    contact: {
      sectionSubtitle: "Get in Touch",
      sectionTitle: "Contact Me",
      email: "pmrobalo@gmail.com",
      linkedin: "LinkedIn"
    },
    
    // Footer
    footer: {
      copyright: "Copyright © 2025 Pedro Robalo. All Rights Reserved."
    },
    
    // Alt text for images
    alt: {
      profilePicture: "Pedro Robalo profile picture",
      experienceIcon: "Experience icon",
      educationIcon: "Education icon",
      checkmarkIcon: "Experience icon",
      emailIcon: "Email icon",
      linkedinIcon: "LinkedIn icon",
      githubIcon: "Github icon"
    }
  },
  
  pt: {
    // Navigation
    nav: {
      about: "Sobre",
      experience: "Experiência",
      projects: "Projetos",
      contact: "Contacto"
    },
    
    // Profile Section
    profile: {
      greeting: "Olá, eu sou",
      name: "Pedro Robalo",
      title: "Engenheiro de Software",
      downloadCV: "Descarregar CV",
      contactInfo: "Contactos"
    },
    
    // About Section
    about: {
      sectionSubtitle: "Conhece Mais",
      sectionTitle: "Sobre Mim",
      experienceTitle: "Experiência",
      experienceText: `${calculateExperience(EXPERIENCE_START_DATES.testAutomation, 'pt')} / ${calculateExperience(EXPERIENCE_START_DATES.nursing.start, 'pt', EXPERIENCE_START_DATES.nursing.end)}<br/>Engenheiro de Automação de Testes / Enfermeiro`,
      educationTitle: "Educação",
      educationText: "Licenciatura em Ciências da Computação<br/>Licenciatura em Enfermagem",
      description: `Sou um Engenheiro de Software apaixonado com uma formação única que abrange tanto a área da saúde como a tecnologia. Com mais de ${calculateExperience(EXPERIENCE_START_DATES.testAutomation, 'pt')} de experiência como Engenheiro de Automação de Testes e uma base em enfermagem, trago uma mentalidade orientada para os detalhes e resolução de problemas a tudo o que faço. A minha jornada da saúde para a tecnologia ensinou-me a importância da precisão, pensamento centrado no utilizador e aprendizagem contínua. Especializo-me em frameworks de automação de testes e quality assurance, enquanto expando constantemente as minhas competências em desenvolvimento full-stack. Prospero na construção de soluções robustas e escaláveis e estou sempre ansioso por enfrentar novos desafios e explorar tecnologias emergentes.`
    },
    
    // Experience Section
    experience: {
      sectionSubtitle: "Explora a Minha",
      sectionTitle: "Experiência",
      frontend: {
        title: "Desenvolvimento Frontend",
        skills: {
          html: { name: "HTML", level: "Experiente" },
          css: { name: "CSS", level: "Básico" },
          tailwind: { name: "Tailwind", level: "Intermédio" },
          react: { name: "React", level: "Básico" },
          svelte: { name: "Svelte", level: "Básico" },
          nextjs: { name: "Next.js", level: "Básico" }
        }
      },
      backend: {
        title: "Desenvolvimento Backend",
        skills: {
          nodejs: { name: "Node.js", level: "Intermédio" },
          prisma: { name: "Prisma", level: "Básico" },
          django: { name: "Django", level: "Básico" },
          mongodb: { name: "MongoDB", level: "Básico" },
          mysql: { name: "MySQL", level: "Básico" },
          graphql: { name: "GraphQL", level: "Básico" }
        }
      },
      testAutomation: {
        title: "Automação de Testes",
        skills: {
          javascript: { name: "JavaScript", level: "Experiente" },
          typescript: { name: "TypeScript", level: "Experiente" },
          python: { name: "Python", level: "Experiente" },
          selenium: { name: "Selenium", level: "Intermédio" },
          appium: { name: "Appium", level: "Experiente" },
          cypress: { name: "Cypress", level: "Experiente" },
          detox: { name: "Detox", level: "Experiente" },
          playwright: { name: "Playwright", level: "Experiente" }
        }
      }
    },
    
    // Projects Section
    projects: {
      sectionSubtitle: "Navega pelos Meus",
      sectionTitle: "Projetos Recentes",
      projectOne: {
        title: "Joke Teller",
        description: "Este projeto é sobre um robô divertido que conta piadas.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectTwo: {
        title: "Nike Store",
        description: "Este projeto é uma plataforma de e-commerce para produtos Nike.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectThree: {
        title: "Music Player",
        description: "Este projeto é uma aplicação de leitor de música construída com JavaScript vanilla.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectFour: {
        title: "Animated Navigation",
        description: "Este projeto mostra um menu de navegação animado.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectFive: {
        title: "Animated Template",
        description: "Este projeto é um template animado que mostra várias animações e transições.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectSix: {
        title: "Quote Generator",
        description: "Este projeto é um gerador de citações inspiradoras que obtém citações aleatórias de uma API.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectSeven: {
        title: "Infinite Scroll",
        description: "Este projeto demonstra funcionalidade de scroll infinito com carregamento dinâmico de conteúdo.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectEight: {
        title: "Custom Countdown",
        description: "Uma aplicação interativa de cronômetro com eventos e datas personalizáveis.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectNine: {
        title: "Book Keeper",
        description: "Uma aplicação de marcadores para organizar e gerir os teus sites e recursos favoritos.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectTen: {
        title: "Form Validator",
        description: "Uma aplicação de validação de formulários do lado do cliente com feedback em tempo real e sanitização de entrada.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectEleven: {
        title: "Spock Rock Game",
        description: "Um jogo melhorado de Pedra-Papel-Tesoura com Spock e Lagarto com jogabilidade animada.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectTwelve: {
        title: "NASA APOD",
        description: "Explora a Imagem Astronômica do Dia da NASA com esta aplicação interativa com imagens do espaço.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectThirteen: {
        title: "Math Sprint Game",
        description: "Um jogo de quiz matemático rápido para testar e melhorar as tuas habilidades aritméticas sob pressão de tempo.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectFourteen: {
        title: "Drag and Drop",
        description: "Uma aplicação interativa de arrastar e soltar demonstrando eventos HTML5 de arrastar e interações dinâmicas de UI.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      },
      projectFifteen: {
        title: "Calculator",
        description: "Uma aplicação de calculadora totalmente funcional com operações matemáticas simples.",
        github: "GitHub",
        liveDemo: "Demo Ao Vivo"
      }
    },
    
    // Contact Section
    contact: {
      sectionSubtitle: "Entra em Contacto",
      sectionTitle: "Contacta-me",
      email: "pmrobalo@gmail.com",
      linkedin: "LinkedIn"
    },
    
    // Footer
    footer: {
      copyright: "Copyright © 2025 Pedro Robalo. Todos os Direitos Reservados."
    },
    
    // Alt text for images
    alt: {
      profilePicture: "Foto de perfil de Pedro Robalo",
      experienceIcon: "Ícone de experiência",
      educationIcon: "Ícone de educação",
      checkmarkIcon: "Ícone de experiência",
      emailIcon: "Ícone de email",
      linkedinIcon: "Ícone do LinkedIn",
      githubIcon: "Ícone do Github"
    }
  }
};

// Global variable to track current language
let currentLanguage = 'en';

// Function to get translation text
function getText(key, language = currentLanguage) {
  const keys = key.split('.');
  let result = translations[language];
  
  for (const k of keys) {
    if (result && result[k]) {
      result = result[k];
    } else {
      console.warn(`Translation key not found: ${key}`);
      return key;
    }
  }
  
  return result;
}

// Function to update all translated elements
function updateTranslations(language = currentLanguage) {
  document.querySelectorAll('[data-translate]').forEach(element => {
    const key = element.getAttribute('data-translate');
    const text = getText(key, language);
    
    if (element.tagName === 'INPUT' && element.type === 'button') {
      element.value = text;
    } else if (text.includes('<br>') || text.includes('<br/>')) {
      element.innerHTML = text;
    } else {
      element.textContent = text;
    }
  });
  
  // Update language toggle buttons
  updateLanguageToggleButtons();
}

// Function to switch language
function switchLanguage(language) {
  if (language === currentLanguage) return;
  
  currentLanguage = language;
  updateTranslations(language);
  
  // Store language preference
  localStorage.setItem('preferredLanguage', language);
}

// Function to update language toggle buttons
function updateLanguageToggleButtons() {
  const desktopToggle = document.querySelector('#desktop-lang-toggle');
  const mobileToggle = document.querySelector('#mobile-lang-toggle');
  
  if (desktopToggle) {
    desktopToggle.innerHTML = currentLanguage === 'en' ? 
      'EN <span class="lang-separator">/</span> <span class="inactive">PT</span>' : 
      '<span class="inactive">EN</span> <span class="lang-separator">/</span> PT';
  }
  
  if (mobileToggle) {
    mobileToggle.innerHTML = currentLanguage === 'en' ? 
      'EN <span class="lang-separator">/</span> <span class="inactive">PT</span>' : 
      '<span class="inactive">EN</span> <span class="lang-separator">/</span> PT';
  }
}

// Function to toggle between languages
function toggleLanguage() {
  const newLanguage = currentLanguage === 'en' ? 'pt' : 'en';
  switchLanguage(newLanguage);
}

// Function to initialize translations on page load
function initializeTranslations() {
  // Get saved language preference or default to English
  const savedLanguage = localStorage.getItem('preferredLanguage') || 'en';
  currentLanguage = savedLanguage;
  
  // Update all translations
  updateTranslations(currentLanguage);
}

// Initialize translations when DOM is loaded
document.addEventListener('DOMContentLoaded', initializeTranslations);
